## Script descriptions

This folder contains all the scripts and modules for the training, evaluation and analysis of the experiments results. Scripts are provided to replicate the experiments and analysis by using the experiment description documents located at `experiment description` folder.

More descriptions and usage instructions are provided in the preamble of each script.

### Training scripts

These scripts have been designed for replicating all the experiments carried over.

* `train_ISTL_noFed_noAct_UCSDPed_val.py`: Trains and evaluate an Incremental Spatio Temporal Learner (ISTL) model by using the UCSD Ped 1 or UCSD Ped 2 train and test sets on a centralized train node, at a single offline training phase. Non-overlapping cuboids are feed during training.

This script runs for experiment descriptions at [experiment description/base_experiments](https://github.com/Nico-Cubero/Surveillance-AnomDetection-FedLearning/tree/master/experiment%20description/base_experiments) folder.

* `train_ISTL_noFed_noAct_UCSDPed_cons_val.py`: Trains and evaluate an Incremental Spatio Temporal Learner (ISTL) model by using the UCSD Ped 1 or UCSD Ped 2 train and test sets on a centralized train node, at a single offline training phase. Overlapping cuboids are feed during training.

This script runs for experiment descriptions at [experiment description/base_experiments](https://github.com/Nico-Cubero/Surveillance-AnomDetection-FedLearning/tree/master/experiment%20description/base_experiments) folder.

* `train_ISTL_noAct_UCSDPed_val.py`: Trains and evaluate an Incremental Spatio Temporal Learner (ISTL) model by using the UCSD Ped 1 or UCSD Ped 2 train and test sets on a simulated synchronous federated learning architecture, at a single offline training phase. Non-overlapping cuboids are feed during training.

This script runs for experiment descriptions `*UCSDPed1*` and `*UCSDPed2*` at [experiment description/fedAvg_offline/](https://github.com/Nico-Cubero/Surveillance-AnomDetection-FedLearning/tree/master/experiment%20description/fedAvg_offline).

* `train_ISTL_noAct_UCSDPed1&2_val.py`: Trains and evaluate an Incremental Spatio Temporal Learner (ISTL) model by using the UCSD Ped 1 and UCSD Ped 2 train and test sets on a simulated synchronous federated learning architecture, at a single offline training phase. Each simulated client node trains exclusively with each dataset. Non-overlapping cuboids are feed during training.

This script runs for experiment description `*UCSDPed1&2*` at [experiment description/fedAvg_offline/](https://github.com/Nico-Cubero/Surveillance-AnomDetection-FedLearning/tree/master/experiment%20description/fedAvg_offline).

* `train_ISTL_Fed_Act_UCSDPed_val.py`: Trains and evaluate an Incremental Spatio Temporal Learner (ISTL) model by using the UCSD Ped 1 or UCSD Ped 2 train and test sets on a simulated synchronous federated learning architecture, at multiple active training phases. Non-overlapping cuboids are feed during training.

This script runs for experiment descriptions `*UCSDPed1*` or `*UCSDPed2*` at [experiment description/fedAvg_active/](https://github.com/Nico-Cubero/Surveillance-AnomDetection-FedLearning/tree/master/experiment%20description/fedAvg_active).

* `train_ISTL_UCSDPed1&2_val.py`: Trains and evaluate an Incremental Spatio Temporal Learner (ISTL) model by using the UCSD Ped 1 and UCSD Ped 2 train and test sets on a simulated synchronous federated learning architecture, at multiple active training phases. Each simulated client node trains exclusively with each dataset. Non-overlapping cuboids are feed during training.

This script runs for experiment descriptions `*UCSDPed1&2*` at [experiment description/fedAvg_active/](https://github.com/Nico-Cubero/Surveillance-AnomDetection-FedLearning/tree/master/experiment%20description/fedAvg_active).

### Evaluation scripts

These scripts are user for replicating and performing further evaluations and testings of the models generated by the training scripts.

* `evaluate_ISTL.py`: Evaluates the prediction of an ISTL model for the UCSD Ped 1 or UCSD Ped 2 test datasets.
* `evaluate_ISTL_detailed.py`: Evaluates the prediction of an ISTL model for the UCSD Ped 1 or UCSD Ped 2 test datasets and elaborates prediction and reconstruction error graphs for each test sample. Spatial anomaly localization can also be evaluated for each sample.
* `rec_ISTL.py`: Performs video test sample reconstruction from a pretrained ISTL model.
* `test_ISTL2.py`: Evaluates the prediction of an ISTL model for a sample of UCSD Ped 1 or UCSD Ped 2 test datasets and elaborates reconstruction error graph, and optionally, its reconstruction.
* `visualize_results.py`: Constructs graphs showing the evolution of quality metrics for each pair of anomaly and temporal thresholds.

### Helper modules

Contains all the scripts and modules providing all the helpers utilities and functions for the training and evaluation scripts.

* `utils.py`: Contains several helper functions used by the scripts.
* `learningRateImprover.py`: Implementation of the Learning Rate Improver callback used for training early stopping on no improvement.
* `models`: Implementation of the model architectures, and utilities for video data feeding.
* `fedLearn`: Implementation of the utilities for simulating a synchronous federated learning architecture model.
